<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="852px" preserveAspectRatio="none" style="width:1051px;height:852px;" version="1.1" viewBox="0 0 1051 852" width="1051px" zoomAndPan="magnify"><defs><filter height="300%" id="fzjtvxsx50kwi" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[d8f9eb381476c1ab6e7b4673404ff11c]
cluster keyboard--><polygon fill="#FFFFFF" filter="url(#fzjtvxsx50kwi)" points="16,6.294,86,6.294,93,29.0939,772,29.0939,772,845.294,16,845.294,16,6.294" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="16" x2="93" y1="29.0939" y2="29.0939"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64" x="20" y="21.2999">keyboard</text><!--MD5=[d132e94edea866007442d98e29e8f036]
cluster interpreter--><polygon fill="#FFFFFF" filter="url(#fzjtvxsx50kwi)" points="796,523.294,873,523.294,880,546.0939,906,546.0939,906,616.294,796,616.294,796,523.294" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="796" x2="880" y1="546.0939" y2="546.0939"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="800" y="538.2999">interpreter</text><!--MD5=[3e09a69be21538652ac4edbcb9c29289]
cluster submitter--><polygon fill="#FFFFFF" filter="url(#fzjtvxsx50kwi)" points="930,523.294,1001,523.294,1008,546.0939,1034,546.0939,1034,616.294,930,616.294,930,523.294" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="930" x2="1008" y1="546.0939" y2="546.0939"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="65" x="934" y="538.2999">submitter</text><!--MD5=[f57290ba224303f1ad01e034b26ebd12]
cluster user_interface--><polygon fill="#FFFFFF" filter="url(#fzjtvxsx50kwi)" points="796,275.294,900,275.294,907,298.0939,910,298.0939,910,368.294,796,368.294,796,275.294" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="796" x2="907" y1="298.0939" y2="298.0939"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="800" y="290.2999">user_interface</text><!--MD5=[8e99fe642d6b0197bff658f760a93d49]
class Interaction--><rect codeLine="5" fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" height="68.3998" id="Interaction" style="stroke: #1A66C2; stroke-width: 1.5;" width="156" x="114" y="48.294"/><ellipse cx="157" cy="61.294" fill="#EB937F" rx="8" ry="8" style="stroke: #1A66C2; stroke-width: 1.0;"/><path d="M155.5156,61.8409 L159.3594,61.8409 L159.3594,60.4659 L155.5156,60.4659 L155.5156,58.6534 L159.6719,58.6534 L159.6719,57.2784 L153.875,57.2784 L153.875,65.294 L159.8594,65.294 L159.8594,63.919 L155.5156,63.919 L155.5156,61.8409 Z "/><ellipse cx="178" cy="60.294" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="51" x="185" y="64.913">Interaction</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="115" x2="269" y1="74.294" y2="74.294"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="120" y="88.5129">Tap(TapDuration, TapMotion)</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="96" x="120" y="101.7128">Swipe(SwipeAction)</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="115" x2="269" y1="108.6938" y2="108.6938"/><!--MD5=[e17bd019cf9874112af63a52ea874b62]
class Keyboard--><rect codeLine="10" fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" height="266.3983" id="Keyboard" style="stroke: #1A66C2; stroke-width: 1.5;" width="582" x="32" y="198.294"/><ellipse cx="290" cy="211.294" fill="#1A66C2" rx="8" ry="8" style="stroke: #1A66C2; stroke-width: 1.0;"/><path d="M293.5,209.9971 C293.4531,209.294 293.2969,208.8565 292.9688,208.4034 C292.3438,207.5909 291.3594,207.1377 290.1563,207.1377 C287.8906,207.1377 286.4844,208.7627 286.4844,211.3565 C286.4844,213.9346 287.875,215.544 290.1094,215.544 C292.1094,215.544 293.4375,214.3877 293.5313,212.5596 L291.9219,212.5596 C291.8125,213.5752 291.1875,214.1534 290.1563,214.1534 C288.875,214.1534 288.1406,213.1221 288.1406,211.3721 C288.1406,209.6065 288.9219,208.544 290.2188,208.544 C291.1719,208.544 291.7031,209.0127 291.9219,209.9971 L293.5,209.9971 Z "/><ellipse cx="311" cy="210.294" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="318" y="214.913">Keyboard</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="33" x2="613" y1="224.294" y2="224.294"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="38" y="238.5129">latched_keys: HashSet&lt;String&gt;</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="38" y="251.7128">layout_of_active_key: String</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="38" y="264.9127">view_of_active_key: String</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="38" y="278.1126">next_layout: Option&lt;String&gt;</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="127" x="38" y="291.3125">next_view: Option&lt;String&gt;</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="33" x2="613" y1="298.2935" y2="298.2935"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="154" x="49" y="312.5124">pub active_view: (String, String)</text><ellipse cx="43" cy="322.4934" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="559" x="49" y="325.7123">from(ui_connector: ui_connector::UIConnector, layout_meta_hashmap: &amp;HashMap&lt;String, LayoutMeta&gt;):Keyboard</text><ellipse cx="43" cy="335.6933" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="228" x="49" y="338.9122">get_views(): &amp;HashMap&lt;(String, String), View&gt;</text><ellipse cx="43" cy="348.8932" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="202" x="49" y="352.1121">input(x: i32, y: i32, interaction: Interaction)</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="232" x="49" y="365.312">handle_tap(x: i32, y: i32, interaction: Interaction)</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="266" x="49" y="378.5119">handle_swipe(x: i32, y: i32, swipe_action: SwipeAction)</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="272" x="49" y="391.7118">execute_tap_actions(key: &amp;Key, interaction: Interaction)</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="421" x="49" y="404.9117">switch_layout(new_layout: Option&lt;String&gt;, new_view: Option&lt;String&gt;, temporary: bool)</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="49" y="418.1116">switch_back_to_prev_view()</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="394" x="49" y="431.3115">get_start_layout_view(available_layout_names: HashSet&lt;String&gt;): (String, String)</text><ellipse cx="43" cy="441.2925" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="49" y="444.5114">fetch_events()</text><ellipse cx="43" cy="454.4924" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="49" y="457.7113">submit_text(text: String)</text><!--MD5=[9d0a6abe319ab0f6f689dce4600b4a3e]
class UIConnector--><rect codeLine="31" fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" height="81.5997" id="UIConnector" style="stroke: #1A66C2; stroke-width: 1.5;" width="278" x="391" y="41.294"/><ellipse cx="489.5" cy="54.294" fill="#1A66C2" rx="8" ry="8" style="stroke: #1A66C2; stroke-width: 1.0;"/><path d="M493,52.9971 C492.9531,52.294 492.7969,51.8565 492.4688,51.4034 C491.8438,50.5909 490.8594,50.1377 489.6563,50.1377 C487.3906,50.1377 485.9844,51.7627 485.9844,54.3565 C485.9844,56.9346 487.375,58.544 489.6094,58.544 C491.6094,58.544 492.9375,57.3877 493.0313,55.5596 L491.4219,55.5596 C491.3125,56.5752 490.6875,57.1534 489.6563,57.1534 C488.375,57.1534 487.6406,56.1221 487.6406,54.3721 C487.6406,52.6065 488.4219,51.544 489.7188,51.544 C490.6719,51.544 491.2031,52.0127 491.4219,52.9971 L493,52.9971 Z "/><ellipse cx="510.5" cy="53.294" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="62" x="517.5" y="57.913">UIConnector</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="392" x2="668" y1="67.294" y2="67.294"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="159" x="397" y="81.5129">message_pipe: relm::Relm&lt;Win&gt;</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="392" x2="668" y1="88.4939" y2="88.4939"/><ellipse cx="402" cy="99.4939" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="255" x="408" y="102.7128">new(message_pipe: relm::Relm&lt;Win&gt;): UIConnector</text><ellipse cx="402" cy="112.6938" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="408" y="115.9127">emit(msg: Msg)</text><!--MD5=[2086e18d236f9616263f91fe5276f8cf]
class Key--><rect codeLine="38" fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" height="121.1994" id="Key" style="stroke: #1A66C2; stroke-width: 1.5;" width="406" x="150" y="708.294"/><ellipse cx="334" cy="721.294" fill="#1A66C2" rx="8" ry="8" style="stroke: #1A66C2; stroke-width: 1.0;"/><path d="M337.5,719.9971 C337.4531,719.294 337.2969,718.8565 336.9688,718.4034 C336.3438,717.5909 335.3594,717.1377 334.1563,717.1377 C331.8906,717.1377 330.4844,718.7627 330.4844,721.3565 C330.4844,723.9346 331.875,725.544 334.1094,725.544 C336.1094,725.544 337.4375,724.3877 337.5313,722.5596 L335.9219,722.5596 C335.8125,723.5752 335.1875,724.1534 334.1563,724.1534 C332.875,724.1534 332.1406,723.1221 332.1406,721.3721 C332.1406,719.6065 332.9219,718.544 334.2188,718.544 C335.1719,718.544 335.7031,719.0127 335.9219,719.9971 L337.5,719.9971 Z "/><ellipse cx="355" cy="720.294" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="19" x="362" y="724.913">Key</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="151" x2="555" y1="734.294" y2="734.294"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="156" y="748.5129">id: String</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="237" x="156" y="761.7128">actions: HashMap&lt;Interaction, Vec&lt;KeyAction&gt;&gt;</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="151" x2="555" y1="768.6938" y2="768.6938"/><ellipse cx="161" cy="779.6938" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="242" x="167" y="782.9127">from(key_name: &amp;str, key_meta: &amp;KeyMeta): Key</text><ellipse cx="161" cy="792.8937" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="167" y="796.1126">get_id(): String</text><ellipse cx="161" cy="806.0936" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="308" x="167" y="809.3125">get_actions(interaction: Interaction): Option&lt;&amp;Vec&lt;KeyAction&gt;&gt;</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="383" x="167" y="822.5124">add_feedback_actions(actions: &amp;mut HashMap&lt;Interaction, Vec&lt;KeyAction&gt;&gt;)</text><!--MD5=[c045e12321b83266d36d22b9096c24ea]
class View--><rect codeLine="48" fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" height="107.9995" id="View" style="stroke: #1A66C2; stroke-width: 1.5;" width="466" x="238" y="525.294"/><ellipse cx="450" cy="538.294" fill="#1A66C2" rx="8" ry="8" style="stroke: #1A66C2; stroke-width: 1.0;"/><path d="M453.5,536.9971 C453.4531,536.294 453.2969,535.8565 452.9688,535.4034 C452.3438,534.5909 451.3594,534.1377 450.1563,534.1377 C447.8906,534.1377 446.4844,535.7627 446.4844,538.3565 C446.4844,540.9346 447.875,542.544 450.1094,542.544 C452.1094,542.544 453.4375,541.3877 453.5313,539.5596 L451.9219,539.5596 C451.8125,540.5752 451.1875,541.1534 450.1563,541.1534 C448.875,541.1534 448.1406,540.1221 448.1406,538.3721 C448.1406,536.6065 448.9219,535.544 450.2188,535.544 C451.1719,535.544 451.7031,536.0127 451.9219,536.9971 L453.5,536.9971 Z "/><ellipse cx="471" cy="537.294" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="478" y="541.913">View</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="239" x2="703" y1="551.294" y2="551.294"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="244" y="565.5129">cell_height: i32</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="244" y="578.7128">cell_width: i32</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="239" x2="703" y1="585.6938" y2="585.6938"/><ellipse cx="249" cy="596.6938" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="443" x="255" y="599.9127">from(key_arrangement: &amp;KeyArrangement, key_meta: &amp;HashMap&lt;String, KeyMeta&gt;): View</text><ellipse cx="249" cy="609.8937" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="273" x="255" y="613.1126">get_closest_key(input_x: i32, input_y: i32): Option&lt;Key&gt;</text><text fill="#333333" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="366" x="255" y="626.3125">get_distance(point_a: (i32, i32), point_b: (i32, i32), max_delta: (i32, i32)): i32</text><ellipse cx="351" cy="82.294" fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" rx="5" ry="5" style="stroke: #1A66C2; stroke-width: 1.5;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="308.5" y="97.5129">KeyboardVisibility</text><ellipse cx="709" cy="82.294" fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" rx="5" ry="5" style="stroke: #1A66C2; stroke-width: 1.5;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="679" y="97.5129">HintPurpose</text><!--MD5=[28760d33e02c4e59700b4cb204473a08]
class LayoutMeta--><rect fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" height="42" id="LayoutMeta" style="stroke: #1A66C2; stroke-width: 1.5;" width="83" x="672.5" y="310.294"/><ellipse cx="684.5" cy="323.294" fill="#1A66C2" rx="8" ry="8" style="stroke: #1A66C2; stroke-width: 1.0;"/><path d="M688,321.9971 C687.9531,321.294 687.7969,320.8565 687.4688,320.4034 C686.8438,319.5909 685.8594,319.1377 684.6563,319.1377 C682.3906,319.1377 680.9844,320.7627 680.9844,323.3565 C680.9844,325.9346 682.375,327.544 684.6094,327.544 C686.6094,327.544 687.9375,326.3877 688.0313,324.5596 L686.4219,324.5596 C686.3125,325.5752 685.6875,326.1534 684.6563,326.1534 C683.375,326.1534 682.6406,325.1221 682.6406,323.3721 C682.6406,321.6065 683.4219,320.544 684.7188,320.544 C685.6719,320.544 686.2031,321.0127 686.4219,321.9971 L688,321.9971 Z "/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="57" x="695.5" y="326.913">LayoutMeta</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="673.5" x2="754.5" y1="336.294" y2="336.294"/><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="673.5" x2="754.5" y1="344.294" y2="344.294"/><!--MD5=[e0a801f788b32b3b7f239adb1f088580]
class interpreter.Interpreter--><rect fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" height="42" id="interpreter.Interpreter" style="stroke: #1A66C2; stroke-width: 1.5;" width="77" x="812.5" y="558.294"/><ellipse cx="824.5" cy="571.294" fill="#1A66C2" rx="8" ry="8" style="stroke: #1A66C2; stroke-width: 1.0;"/><path d="M828,569.9971 C827.9531,569.294 827.7969,568.8565 827.4688,568.4034 C826.8438,567.5909 825.8594,567.1377 824.6563,567.1377 C822.3906,567.1377 820.9844,568.7627 820.9844,571.3565 C820.9844,573.9346 822.375,575.544 824.6094,575.544 C826.6094,575.544 827.9375,574.3877 828.0313,572.5596 L826.4219,572.5596 C826.3125,573.5752 825.6875,574.1534 824.6563,574.1534 C823.375,574.1534 822.6406,573.1221 822.6406,571.3721 C822.6406,569.6065 823.4219,568.544 824.7188,568.544 C825.6719,568.544 826.2031,569.0127 826.4219,569.9971 L828,569.9971 Z "/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="51" x="835.5" y="574.913">Interpreter</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="813.5" x2="888.5" y1="584.294" y2="584.294"/><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="813.5" x2="888.5" y1="592.294" y2="592.294"/><!--MD5=[1711a177874a92b72a79392e155e0c16]
class submitter.Submitter--><rect fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" height="42" id="submitter.Submitter" style="stroke: #1A66C2; stroke-width: 1.5;" width="72" x="946" y="558.294"/><ellipse cx="958" cy="571.294" fill="#1A66C2" rx="8" ry="8" style="stroke: #1A66C2; stroke-width: 1.0;"/><path d="M961.5,569.9971 C961.4531,569.294 961.2969,568.8565 960.9688,568.4034 C960.3438,567.5909 959.3594,567.1377 958.1563,567.1377 C955.8906,567.1377 954.4844,568.7627 954.4844,571.3565 C954.4844,573.9346 955.875,575.544 958.1094,575.544 C960.1094,575.544 961.4375,574.3877 961.5313,572.5596 L959.9219,572.5596 C959.8125,573.5752 959.1875,574.1534 958.1563,574.1534 C956.875,574.1534 956.1406,573.1221 956.1406,571.3721 C956.1406,569.6065 956.9219,568.544 958.2188,568.544 C959.1719,568.544 959.7031,569.0127 959.9219,569.9971 L961.5,569.9971 Z "/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="969" y="574.913">Submitter</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="947" x2="1017" y1="584.294" y2="584.294"/><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="947" x2="1017" y1="592.294" y2="592.294"/><!--MD5=[febb0e59bf5db791293ce68f42ffbec9]
class user_interface.Msg--><rect fill="#CCCCCC" filter="url(#fzjtvxsx50kwi)" height="42" id="user_interface.Msg" style="stroke: #1A66C2; stroke-width: 1.5;" width="47" x="812.5" y="310.294"/><ellipse cx="824.5" cy="323.294" fill="#1A66C2" rx="8" ry="8" style="stroke: #1A66C2; stroke-width: 1.0;"/><path d="M828,321.9971 C827.9531,321.294 827.7969,320.8565 827.4688,320.4034 C826.8438,319.5909 825.8594,319.1377 824.6563,319.1377 C822.3906,319.1377 820.9844,320.7627 820.9844,323.3565 C820.9844,325.9346 822.375,327.544 824.6094,327.544 C826.6094,327.544 827.9375,326.3877 828.0313,324.5596 L826.4219,324.5596 C826.3125,325.5752 825.6875,326.1534 824.6563,326.1534 C823.375,326.1534 822.6406,325.1221 822.6406,323.3721 C822.6406,321.6065 823.4219,320.544 824.7188,320.544 C825.6719,320.544 826.2031,321.0127 826.4219,321.9971 L828,321.9971 Z "/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="835.5" y="326.913">Msg</text><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="813.5" x2="858.5" y1="336.294" y2="336.294"/><line style="stroke: #1A66C2; stroke-width: 1.5;" x1="813.5" x2="858.5" y1="344.294" y2="344.294"/><!--MD5=[6444a03a49a01479d109eece99c39d56]
reverse link Keyboard to interpreter.Interpreter--><path codeLine="57" d="M626.39,454.114 C701.65,484.694 763.53,510.334 772,515.294 C792.89,527.534 814.21,544.884 829.43,558.284 " fill="none" id="Keyboard-backto-interpreter.Interpreter" style="stroke: #000000; stroke-width: 1.0;"/><polygon fill="#000000" points="614.2,449.164,618.2501,455.1303,625.3152,453.6865,621.2651,447.7202,614.2,449.164" style="stroke: #000000; stroke-width: 1.0;"/><!--MD5=[abad6ac82ff0529a0dbcc781903721eb]
reverse link Keyboard to submitter.Submitter--><path codeLine="58" d="M626.84,455.554 C636.3,458.604 645.7,461.524 655,464.294 C764.1,496.784 803.32,466.164 906,515.294 C927.95,525.794 948.94,544.034 963.27,558.194 " fill="none" id="Keyboard-backto-submitter.Submitter" style="stroke: #000000; stroke-width: 1.0;"/><polygon fill="#000000" points="614.37,451.474,618.8288,457.1414,625.7751,455.2054,621.3164,449.538,614.37,451.474" style="stroke: #000000; stroke-width: 1.0;"/><!--MD5=[0a8a972d4a61ef06a2ac8070a49ebd36]
link UIConnector to Keyboard--><path codeLine="59" d="M496.28,123.524 C481.04,141.714 462.03,164.394 442.23,188.024 " fill="none" id="UIConnector-to-Keyboard" style="stroke: #000000; stroke-width: 1.0;"/><polygon fill="#000000" points="433.71,198.194,440.6294,196.1639,441.4168,188.9959,434.4974,191.026,433.71,198.194" style="stroke: #000000; stroke-width: 1.0;"/><!--MD5=[38c51f52bfb3790df7ea0b3d4009c380]
reverse link Keyboard to Key--><path codeLine="60" d="M158.68,475.494 C150.18,488.184 142.79,501.484 137,515.294 C116.73,563.664 111.54,587.444 137,633.294 C154.1,664.094 181.51,688.754 211.15,708.114 " fill="none" id="Keyboard-backto-Key" style="stroke: #000000; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="166.41,464.504,159.6871,467.1122,159.509,474.3211,166.2319,471.7129,166.41,464.504" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#333333" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="138" y="583.0129">saves last active</text><text fill="#333333" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="174.7652" y="697.1454">0..1</text><!--MD5=[8996c6e07f47f4dd6995ebc5fb0a8bb5]
reverse link Keyboard to View--><path codeLine="61" d="M409.37,475.854 C419.89,493.344 430.07,510.274 439.03,525.154 " fill="none" id="Keyboard-backto-View" style="stroke: #000000; stroke-width: 1.0;"/><polygon fill="#000000" points="402.42,464.294,402.0838,471.4972,408.6036,474.5781,408.9399,467.3748,402.42,464.294" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#333333" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="27" x="405.92" y="514.2379">many</text><!--MD5=[acbb6e3f68cdcaef70f2e35d0fddd043]
link UIConnectorlol17 to UIConnector--><path d="M356.24,82.294 C367.78,82.294 379.32,82.294 390.86,82.294 " fill="none" id="UIConnectorlol17-UIConnector" style="stroke: #000000; stroke-width: 1.0;"/><!--MD5=[76f5a1b5ea03483ed473471be9ef647c]
link UIConnector to UIConnectorlol20--><path d="M669.14,82.294 C680.67,82.294 692.19,82.294 703.71,82.294 " fill="none" id="UIConnector-UIConnectorlol20" style="stroke: #000000; stroke-width: 1.0;"/><!--MD5=[b33916f1cb788221c5e6fc21bae60951]
reverse link View to Key--><path codeLine="64" d="M430.46,644.704 C417.52,665.284 403.25,687.944 390.53,708.164 " fill="none" id="View-backto-Key" style="stroke: #000000; stroke-width: 1.0;"/><polygon fill="#000000" points="437.5,633.524,430.9204,636.4751,431.1139,643.6836,437.6935,640.7325,437.5,633.524" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#333333" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="416" y="674.5129">stores position</text><text fill="#333333" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="27" x="366.4587" y="697.2015">many</text><!--MD5=[85709df1dcf9b2ae2437120fee6ede7c]
link Keyboard to LayoutMeta--><path codeLine="66" d="M614.07,331.294 C636.19,331.294 656.15,331.294 672.31,331.294 " fill="none" id="Keyboard-LayoutMeta" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#333333" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="22" x="632.25" y="324.5129">from</text><text fill="#333333" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="27" x="637.5489" y="342.441">many</text><!--MD5=[dd537d29fde41df253ef7d83115bb98c]
link UIConnector to user_interface.Msg--><path codeLine="67" d="M654.53,123.404 C695.71,141.314 739.31,165.854 772,198.294 C804.18,230.224 822.55,281.564 830.76,309.894 " fill="none" id="UIConnector-user_interface.Msg" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#333333" font-family="Verdana" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="733" y="164.5129">emits</text><!--MD5=[acaa5cf8c6b12670caa6d4fdf6b128a5]
@startuml keyboard
!define LIGHTBLUE
!includeurl https://raw.githubusercontent.com/grelltrier/RedDress-PlantUML/master/style.puml

package keyboard {
    +enum Interaction {
        {field} Tap(TapDuration, TapMotion)
        {field} Swipe(SwipeAction)
    }

    +class Keyboard {
        pub active_view: (String, String)
        latched_keys: HashSet<String>
        layout_of_active_key: String
        view_of_active_key: String
        next_layout: Option<String>
        next_view: Option<String>

        {static} +from(ui_connector: ui_connector::UIConnector, layout_meta_hashmap: &HashMap<String, LayoutMeta>):Keyboard
        +get_views(): &HashMap<(String, String), View>
        +input(x: i32, y: i32, interaction: Interaction)
        handle_tap(x: i32, y: i32, interaction: Interaction)
        handle_swipe(x: i32, y: i32, swipe_action: SwipeAction)
        execute_tap_actions(key: &Key, interaction: Interaction)
        switch_layout(new_layout: Option<String>, new_view: Option<String>, temporary: bool) 
        switch_back_to_prev_view()
        get_start_layout_view(available_layout_names: HashSet<String>): (String, String)
        +fetch_events()
        +submit_text(text: String)
    }

    +class UIConnector {
        message_pipe: relm::Relm<Win>

        {static} +new(message_pipe: relm::Relm<Win>): UIConnector
        +emit(msg: Msg)
    }

    +class Key {
        id: String
        actions: HashMap<Interaction, Vec<KeyAction>>

        {static} +from(key_name: &str, key_meta: &KeyMeta): Key
        +get_id(): String
        +get_actions(interaction: Interaction): Option<&Vec<KeyAction>>
        {static} add_feedback_actions(actions: &mut HashMap<Interaction, Vec<KeyAction>>)
    }

    +class View {
        cell_height: i32
        cell_width: i32

        {static} +from(key_arrangement: &KeyArrangement, key_meta: &HashMap<String, KeyMeta>): View
        +get_closest_key(input_x: i32, input_y: i32): Option<Key>
        {static} get_distance(point_a: (i32, i32), point_b: (i32, i32), max_delta: (i32, i32)): i32
    }

    Keyboard *- - interpreter.Interpreter
    Keyboard *- - submitter.Submitter
    UIConnector - -* Keyboard
    Keyboard o- - "0..1" Key : saves last active
    Keyboard *- - "many" View
    KeyboardVisibility ()- UIConnector
    UIConnector -() HintPurpose
    View *- - "many" Key : stores position

    Keyboard - "many" LayoutMeta : from
    UIConnector - - user_interface.Msg : emits
}
@enduml

@startuml keyboard




skinparam stereotypeCBackgroundColor 1a66c2







skinparam backgroundColor fff








skinparam circledCharacter {
  radius 8
  fontSize 11
  fontName Verdana
}

skinparam class {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Verdana
  arrowFontColor 333
  arrowFontSize 11

  attributeFontColor 333
  attributeFontSize 11
  attributeIconSize 11
}


skinparam ActivityBarColor 1a66c2
skinparam activityDiamondBackgroundColor ccc
skinparam activityDiamondBorderColor 1a66c2


skinparam actor {
    backgroundColor 2a86e2
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam participant {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam collections {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam SequenceBox{
    backgroundColor e0e0e0
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}


skinparam interface {
    backgroundColor 2a86e2
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam component {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam node {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam database {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam queue {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}


skinparam usecase {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Verdana
  arrowFontColor 333
  arrowFontSize 11
}

skinparam activity {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Verdana
  arrowFontColor 333
  arrowFontSize 11
}

skinparam sequence {
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Verdana
  arrowFontColor 333
  arrowFontSize 11

  lifeLineBorderColor 2a86e2
  lifeLineBackgroundColor e0e0e0
}

skinparam boundary {
    backgroundColor 2a86e2
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam control {
    backgroundColor 2a86e2
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam entity {
    backgroundColor 2a86e2
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}


skinparam state {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Verdana
  arrowFontColor 333
  arrowFontSize 11
  startColor 2a86e2
  endColor 1a66c2
}


skinparam object {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Verdana
  arrowFontColor 333
  arrowFontSize 11
}


skinparam note {
    backgroundColor 2a86e2
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam cloud {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Verdana
  arrowFontColor 333
  arrowFontSize 11
}

skinparam rectangle {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam storage {
    backgroundColor ccc
  borderColor 1a66c2
    fontColor 000
  fontName Verdana
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}


package keyboard {
    +enum Interaction {
        {field} Tap(TapDuration, TapMotion)
        {field} Swipe(SwipeAction)
    }

    +class Keyboard {
        pub active_view: (String, String)
        latched_keys: HashSet<String>
        layout_of_active_key: String
        view_of_active_key: String
        next_layout: Option<String>
        next_view: Option<String>

        {static} +from(ui_connector: ui_connector::UIConnector, layout_meta_hashmap: &HashMap<String, LayoutMeta>):Keyboard
        +get_views(): &HashMap<(String, String), View>
        +input(x: i32, y: i32, interaction: Interaction)
        handle_tap(x: i32, y: i32, interaction: Interaction)
        handle_swipe(x: i32, y: i32, swipe_action: SwipeAction)
        execute_tap_actions(key: &Key, interaction: Interaction)
        switch_layout(new_layout: Option<String>, new_view: Option<String>, temporary: bool) 
        switch_back_to_prev_view()
        get_start_layout_view(available_layout_names: HashSet<String>): (String, String)
        +fetch_events()
        +submit_text(text: String)
    }

    +class UIConnector {
        message_pipe: relm::Relm<Win>

        {static} +new(message_pipe: relm::Relm<Win>): UIConnector
        +emit(msg: Msg)
    }

    +class Key {
        id: String
        actions: HashMap<Interaction, Vec<KeyAction>>

        {static} +from(key_name: &str, key_meta: &KeyMeta): Key
        +get_id(): String
        +get_actions(interaction: Interaction): Option<&Vec<KeyAction>>
        {static} add_feedback_actions(actions: &mut HashMap<Interaction, Vec<KeyAction>>)
    }

    +class View {
        cell_height: i32
        cell_width: i32

        {static} +from(key_arrangement: &KeyArrangement, key_meta: &HashMap<String, KeyMeta>): View
        +get_closest_key(input_x: i32, input_y: i32): Option<Key>
        {static} get_distance(point_a: (i32, i32), point_b: (i32, i32), max_delta: (i32, i32)): i32
    }

    Keyboard *- - interpreter.Interpreter
    Keyboard *- - submitter.Submitter
    UIConnector - -* Keyboard
    Keyboard o- - "0..1" Key : saves last active
    Keyboard *- - "many" View
    KeyboardVisibility ()- UIConnector
    UIConnector -() HintPurpose
    View *- - "many" Key : stores position

    Keyboard - "many" LayoutMeta : from
    UIConnector - - user_interface.Msg : emits
}
@enduml

PlantUML version 1.2020.19(Mon Oct 12 17:10:01 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>