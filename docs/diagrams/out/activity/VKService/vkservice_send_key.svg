<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="506px" preserveAspectRatio="none" style="width:700px;height:506px;" version="1.1" viewBox="0 0 700 506" width="700px" zoomAndPan="magnify"><defs><filter height="300%" id="f1q69856doi69" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1q69856doi69)" height="478.8004" style="stroke: #000000; stroke-width: 2.0;" width="672" x="11" y="11"/><path d="M165,12 L165,20.7999 L155,30.7999 L11,30.7999 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="14" y="25.0059">VKService::send_key()</text><ellipse cx="474.875" cy="50.7999" fill="#000000" filter="url(#f1q69856doi69)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><polygon fill="#FEFECE" filter="url(#f1q69856doi69)" points="437.875,80.7999,511.875,80.7999,523.875,92.7999,511.875,104.7999,437.875,104.7999,425.875,92.7999,437.875,80.7999" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="74" x="437.875" y="96.4189">Keycode valid?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="407.875" y="89.8189">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="523.875" y="89.8189">no</text><polygon fill="#FEFECE" filter="url(#f1q69856doi69)" points="286.75,114.7999,398.75,114.7999,410.75,126.7999,398.75,138.7999,286.75,138.7999,274.75,126.7999,286.75,114.7999" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="112" x="286.75" y="130.4189">virtual_keyboard proxy</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="22" x="252.75" y="123.8189">alive</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="40" x="410.75" y="123.8189">not alive</text><polygon fill="#FEFECE" filter="url(#f1q69856doi69)" points="192.5,148.7999,242.5,148.7999,254.5,160.7999,242.5,172.7999,192.5,172.7999,180.5,160.7999,192.5,148.7999" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="192.5" y="164.4189">keymotion</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="152.5" y="157.8189">press</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="36" x="254.5" y="157.8189">release</text><rect fill="#FEFECE" filter="url(#f1q69856doi69)" height="34.4001" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="194" x="23" y="182.7999"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="174" x="33" y="203.948">Remove key from pressed_keys</text><rect fill="#FEFECE" filter="url(#f1q69856doi69)" height="34.4001" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="156" x="237" y="182.7999"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="136" x="247" y="203.948">Add key to pressed_keys</text><polygon fill="#FEFECE" filter="url(#f1q69856doi69)" points="217.5,223.2,229.5,235.2,217.5,247.2,205.5,235.2,217.5,223.2" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1q69856doi69)" height="48.8002" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="196" x="119.5" y="272.6001"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="176" x="129.5" y="293.7482">Use virtual_keyboard protocol to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="136" x="129.5" y="308.1483">press/release of keycode</text><rect fill="#FEFECE" filter="url(#f1q69856doi69)" height="34.4001" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="192" y="341.4003"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="31" x="202" y="362.5484">Ok(())</text><rect fill="#FEFECE" filter="url(#f1q69856doi69)" height="34.4001" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="431.5" y="148.7999"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="53" x="441.5" y="169.948">Emit error</text><rect fill="#FEFECE" filter="url(#f1q69856doi69)" height="34.4001" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="423" y="218.2"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="433" y="239.3481">Err(NotAlive)</text><polygon fill="#FEFECE" filter="url(#f1q69856doi69)" points="342.75,381.8004,354.75,393.8004,342.75,405.8004,330.75,393.8004,342.75,381.8004" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1q69856doi69)" height="34.4001" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="570.5" y="114.7999"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="53" x="580.5" y="135.948">Emit error</text><rect fill="#FEFECE" filter="url(#f1q69856doi69)" height="34.4001" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="543" y="184.2"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="553" y="205.3481">Err(InvalidKeycode)</text><polygon fill="#FEFECE" filter="url(#f1q69856doi69)" points="474.875,411.8004,486.875,423.8004,474.875,435.8004,462.875,423.8004,474.875,411.8004" style="stroke: #A80036; stroke-width: 1.5;"/><ellipse cx="474.875" cy="466.8004" fill="#FFFFFF" filter="url(#f1q69856doi69)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="474.875" cy="466.8004" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="180.5" x2="120" y1="160.7999" y2="160.7999"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="120" x2="120" y1="160.7999" y2="182.7999"/><polygon fill="#A80036" points="116,172.7999,120,182.7999,124,172.7999,120,176.7999" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="254.5" x2="315" y1="160.7999" y2="160.7999"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="315" x2="315" y1="160.7999" y2="182.7999"/><polygon fill="#A80036" points="311,172.7999,315,182.7999,319,172.7999,315,176.7999" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="120" x2="120" y1="217.2" y2="235.2"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="120" x2="205.5" y1="235.2" y2="235.2"/><polygon fill="#A80036" points="195.5,231.2,205.5,235.2,195.5,239.2,199.5,235.2" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="315" x2="315" y1="217.2" y2="235.2"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="315" x2="229.5" y1="235.2" y2="235.2"/><polygon fill="#A80036" points="239.5,231.2,229.5,235.2,239.5,239.2,235.5,235.2" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="217.5" x2="217.5" y1="247.2" y2="272.6001"/><polygon fill="#A80036" points="213.5,262.6001,217.5,272.6001,221.5,262.6001,217.5,266.6001" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="217.5" x2="217.5" y1="321.4003" y2="341.4003"/><polygon fill="#A80036" points="213.5,331.4003,217.5,341.4003,221.5,331.4003,217.5,335.4003" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="468" x2="468" y1="183.2" y2="218.2"/><polygon fill="#A80036" points="464,208.2,468,218.2,472,208.2,468,212.2" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="274.75" x2="217.5" y1="126.7999" y2="126.7999"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="217.5" x2="217.5" y1="126.7999" y2="148.7999"/><polygon fill="#A80036" points="213.5,138.7999,217.5,148.7999,221.5,138.7999,217.5,142.7999" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="410.75" x2="468" y1="126.7999" y2="126.7999"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="468" x2="468" y1="126.7999" y2="148.7999"/><polygon fill="#A80036" points="464,138.7999,468,148.7999,472,138.7999,468,142.7999" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="217.5" x2="217.5" y1="375.8004" y2="393.8004"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="217.5" x2="330.75" y1="393.8004" y2="393.8004"/><polygon fill="#A80036" points="320.75,389.8004,330.75,393.8004,320.75,397.8004,324.75,393.8004" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="468" x2="468" y1="252.6001" y2="393.8004"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="468" x2="354.75" y1="393.8004" y2="393.8004"/><polygon fill="#A80036" points="364.75,389.8004,354.75,393.8004,364.75,397.8004,360.75,393.8004" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="607" x2="607" y1="149.2" y2="184.2"/><polygon fill="#A80036" points="603,174.2,607,184.2,611,174.2,607,178.2" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="425.875" x2="342.75" y1="92.7999" y2="92.7999"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="342.75" x2="342.75" y1="92.7999" y2="114.7999"/><polygon fill="#A80036" points="338.75,104.7999,342.75,114.7999,346.75,104.7999,342.75,108.7999" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="523.875" x2="607" y1="92.7999" y2="92.7999"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="607" x2="607" y1="92.7999" y2="114.7999"/><polygon fill="#A80036" points="603,104.7999,607,114.7999,611,104.7999,607,108.7999" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="342.75" x2="342.75" y1="405.8004" y2="423.8004"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="342.75" x2="462.875" y1="423.8004" y2="423.8004"/><polygon fill="#A80036" points="452.875,419.8004,462.875,423.8004,452.875,427.8004,456.875,423.8004" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="607" x2="607" y1="218.6001" y2="423.8004"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="607" x2="486.875" y1="423.8004" y2="423.8004"/><polygon fill="#A80036" points="496.875,419.8004,486.875,423.8004,496.875,427.8004,492.875,423.8004" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="474.875" x2="474.875" y1="60.7999" y2="80.7999"/><polygon fill="#A80036" points="470.875,70.7999,474.875,80.7999,478.875,70.7999,474.875,74.7999" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="474.875" x2="474.875" y1="435.8004" y2="455.8004"/><polygon fill="#A80036" points="470.875,445.8004,474.875,455.8004,478.875,445.8004,474.875,449.8004" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[8de418311b5621e8b6afe8c8dd2bf116]
@startuml vkservice_send_key

partition "VKService::send_key()"{
  start
    if (Keycode valid?) then (yes)
      if (virtual_keyboard proxy) then (alive)
        if (keymotion) then (press)
          :Remove key from pressed_keys;
        else (release)
          :Add key to pressed_keys;
        endif
        :Use virtual_keyboard protocol to
        press/release of keycode;
        :Ok(())]

      else (not alive)
        :Emit error;
        :Err(NotAlive)]
      endif

    else (no)
      :Emit error;
      :Err(InvalidKeycode)]
    endif
  stop
@enduml

PlantUML version 1.2020.15(Sun Jun 28 13:39:45 CEST 2020)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>